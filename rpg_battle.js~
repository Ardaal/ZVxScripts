({
    battleStep: function (ctx)
    {
        var rpg = ctx.rpg;
        var name = ctx.battle;

        var battle = this.battles[name];

        var team_players = [];
        for (var x in battle.players)
        {
            team_players.push(this.players[battle.players[x]]);
            // Battle players contains NAMES of players, not the player objects!
        }

        var team_mobs = [];
        for (var x in battle.mobs)
        {
            team_mobs.push(battle.mobs[x]);
        }
        
        var entities = [];


        for (var x in team_players)
        {
            entities.push({type: "player", e: team_players[x]});
        }

        for (var x in team_players)
        {
            entities.push({type: "mob", e: team_mobs[x]});
        }
        

        entities.sort( 
            function _sorting_function_ (a, b)
            {
                return a.speed - b.speed;
            }
        );
        
    }
    
});
